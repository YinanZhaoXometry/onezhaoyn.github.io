{"pageProps":{"note":{"id":"namt3sv2t4my5y07vzlqhf3","title":"跨域是什么？","desc":"","updated":1677377931342,"created":1677377925926,"custom":{},"fname":"20181109-跨域是什么？","type":"note","vault":{"fsPath":"vault","name":"vault"},"contentHash":"f0a8d0fc0a487ee3c9cba392f2258d56","links":[],"anchors":{"什么是跨域":{"type":"header","text":"什么是跨域？","value":"什么是跨域","line":18,"column":0,"depth":4},"为什么禁止跨域访问":{"type":"header","text":"为什么禁止跨域访问？","value":"为什么禁止跨域访问","line":51,"column":0,"depth":3},"另外谈-3-点小东西":{"type":"header","text":"另外谈 3 点小东西","value":"另外谈-3-点小东西","line":59,"column":0,"depth":3}},"children":[],"parent":"9ulx2r70mqzuktc8d2y4dqt","data":{}},"body":"<h1 id=\"跨域是什么\">跨域是什么？<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#跨域是什么\"></a></h1>\n<blockquote>\n<p>写于：2018-11-09</p>\n</blockquote>\n<p>在当你再向另一主机上的文件发送 HTTP 请求时，浏览器会在 Console 里提示如下：</p>\n<pre><code>XMLHttpRequest cannot load http://xxx.xxx. No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://my.app' is therefore not allowed access.\n</code></pre>\n<p>提示你当前的行为属于<strong>跨域访问</strong>，出于对网络安全的考量这种类型的访问是被严格禁止的。</p>\n<h4 id=\"什么是跨域\">什么是跨域？<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#什么是跨域\"></a></h4>\n<p>跨域，其实是指访问了或读取了储存在<strong>不同源的地址</strong>（详见下方文字）下的文件，比如读取 cookie、向其发送 HTTP 请求获取其返回的数据等等。而这种访问其实违反了互联网的安全基石：<strong>同源政策 Same-origin policy</strong>。\n同源政策于 1995 年由网景公司提出，该政策最初是为了避免非法获取和操控 DOM 对象（Document Object Model 文档对象模型），而今已拓展到对于全局 JavaScript 对象的保护。\n要弄清楚跨域，看来有必要先了解“同源”(Same origin)是什么，同源有 3 个要素，即：</p>\n<pre><code>**同协议、同域名、同端口**\n</code></pre>\n<p>我们平时上网输入的百度网址 <a href=\"http://www.baidu.com%EF%BC%8C%E5%85%B6%E5%AE%9E%E5%8F%AA%E6%98%AF%E7%BD%91%E5%9D%80%E5%85%A8%E7%A7%B0%E7%9A%84%E4%B8%80%E9%83%A8%E5%88%86%EF%BC%8C%E5%8D%B3**%E5%9F%9F%E5%90%8D**%EF%BC%8C**%E5%8D%8F%E8%AE%AE**%E5%8C%85%E5%90%AB%EF%BC%9Ahttp\">www.baidu.com，其实只是网址全称的一部分，即**域名**，**协议**包含：http</a> 超文本传输协议和 https 超文本传输安全协议，<strong>端口号</strong>最常用的是 80 端口，该端口为默认端口一般省略不写。拿百度的网址全名做例子：[https://ws3.sinaimg.cn/large/006tNbRwly1fwz7cguhqmj304x00vjra.jpg]</p>\n<pre><code>协议：http\n域名：www.baidu.com\n端口：80（默认端口号，可省）\n</code></pre>\n<p>上述 3 个要素只要变一个就被不“同源”或跨域，违反了同源政策，比如：</p>\n<pre><code>https://www.baidu.com:80\nhttp://baidu.com:80\nhttp://www.baidu.com:81\n</code></pre>\n<p>而以下的网址使用的是同一协议（http）、域名（<a href=\"http://www.baidu.com%EF%BC%89%E3%80%81%E5%92%8C%E7%AB%AF%E5%8F%A3%EF%BC%8880%EF%BC%89%E5%88%99%E7%AC%A6%E5%90%88%E5%90%8C%E6%BA%90%EF%BC%8C%E4%B8%8D%E8%A2%AB%E8%A7%86%E4%BD%9C%E8%B7%A8%E5%9F%9F%EF%BC%9A\">www.baidu.com）、和端口（80）则符合同源，不被视作跨域：</a></p>\n<pre><code>http://www.baidu.com/1.html\nhttp:///www.baidu.com/dir/2.html\n</code></pre>\n<h3 id=\"为什么禁止跨域访问\">为什么禁止跨域访问？<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#为什么禁止跨域访问\"></a></h3>\n<p>同源政策禁止跨域访问，该政策被视作互联网安全的基石，所有的现代浏览器都遵守该政策，禁止跨域访问。\n跨域访问哪儿妨碍了互联网安全了呢？\n其实最关键的是，跨域访问可以通过访问不同网站保存在本地的 cookie，而在 cookie 中保存了敏感信息，比如用户登录信息，一旦 cookie 被访问/操纵，意味着第三方能够以用户本人的身份自由的与服务器通信（服务器根本不知道用户数据被盗），因此第三方自由进入你的网银账户，试想：如果有人冒充你本人，去银行转账/查询所有交易记录，或者直接挂失/销户，你是什么感觉？\n因此，跨域访问所防范的，其实是恶意网站上的恶意代码，通过其他网站保存在本地的文件（包括 cookie），非法获取用户信息/数据。\n现在应该能明白为什么同源政策是互联网安全的基石了：一旦不同源网站能自由访问彼此的文件，后果将不堪设想。</p>\n<h3 id=\"另外谈-3-点小东西\">另外谈 3 点小东西<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#另外谈-3-点小东西\"></a></h3>\n<ol>\n<li>为什么跨域访问要由客户端，也就是浏览器来管理，而不是服务器端呢？\n由于这种情况服务器根本无从知晓：一台客户端跨域访问另一台客户端计算机（或者同一客户端上，一个网站读取另一网站储存在本地的 cookie），读取其文件和数据，然后利用获取的信息向服务器发送请求，服务器根本无从分辨发送请求的是谁。\n因此跨域访问或同源政策的实施，必须只能在客户端进行管理。</li>\n<li>跨域访问阻止的是什么？\n跨域写（write）是被允许的，因此你的跨域访问信息会被对方接收到，真正被禁止的其实是跨域读（read）。因此跨域请求的响应信息、甚至响应码，我们都是收不到的，因为被浏览器屏蔽掉了。</li>\n<li>有跨域读取被允许的现象吗\n其实通过 HTML 的标签跨域载入以下资源（字体除外）是被允许的：图片、CSS 样式表、JS 文件。\n这些文件是通过下载到本地再进行运行的。\n延伸阅读：\n<a href=\"http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html\">阮一峰：浏览器同源政策及其规避方法</a>\n<a href=\"https://en.wikipedia.org/wiki/Same-origin_policy#cite_note-2\">Same-origin policy - Wikipedia</a>\n<a href=\"https://jvaneyck.wordpress.com/2014/01/07/cross-domain-requests-in-javascript/\">Cross-Domain requests in Javascript | jvaneyck</a></li>\n</ol>","noteIndex":{"id":"9ulx2r70mqzuktc8d2y4dqt","title":"Root","desc":"","updated":1677372670607,"created":1677372670607,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault","name":"vault"},"contentHash":"d1b3b549bffbc9406db1ab2a62f7532a","links":[],"anchors":{"welcome-to-dendron":{"type":"header","text":"Welcome to Dendron","value":"welcome-to-dendron","line":7,"column":0,"depth":1},"lookup":{"type":"header","text":"Lookup","value":"lookup","line":11,"column":0,"depth":2}},"children":["06npfpt8dfn6bek5i4ot77o","2qgkc58zn6cl7flma4g7msu","di3ufysjttt06q6allkds6y","n140devp4qgpdzgu03kp2a4","3iezwurw0dx7qo5zfgjqrqi","namt3sv2t4my5y07vzlqhf3","x26u7mxd81wcam73qz7b0gk","h1fu09ilp1qb1ljhczwg7n7","i1nu3sxndp3cuo3lwzuz203","b50kz068s83h4oubvlxogkw"],"parent":null,"data":{},"body":"# Welcome to Dendron\n\nThis is the root of your dendron vault. If you decide to publish your entire vault, this will be your landing page. You are free to customize any part of this page except the frontmatter on top.\n\n## Lookup\n\nThis section contains useful links to related resources.\n\n- [Getting Started Guide](https://link.dendron.so/6b25)\n- [Discord](https://link.dendron.so/6b23)\n- [Home Page](https://wiki.dendron.so/)\n- [Github](https://link.dendron.so/6b24)\n- [Developer Docs](https://docs.dendron.so/)"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault","name":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"dendronVersion":"0.85.0","enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Yinan Zhao's Blog","description":"个人博客"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","siteUrl":"https://onezhaoyn.github.io","hierarchyDisplayTitle":"子集文章","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}